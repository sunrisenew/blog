import{_ as t,r as e,o as p,c as i,a as s,b as n,d as o,f as c,e as l}from"./app-DRb6Vypl.js";const r={},u=s("p",null,[n("为了提高页面的可访问性，使用微信内置浏览器打开H5页面时，用户可以通过点击右上角菜单中的"),s("code",null,"调整字体"),n("来放大或缩小文字，以达到最佳的阅读效果。这个功能对于许多老人或者视力障碍人士非常有用，但是如果页面没有专门适配不同的字体大小，那么页面布局就会变得非常混乱。")],-1),d={href:"https://github.com/niklasvh/html2canvas",target:"_blank",rel:"noopener noreferrer"},k=s("p",null,"所以如果这项功能对业务常用人群没有太大的作用或者某些页面强制要求禁止缩放，我们可以禁用这项功能。",-1),v=l(`<h2 id="解决方法" tabindex="-1"><a class="header-anchor" href="#解决方法"><span>解决方法</span></a></h2><h3 id="ios" tabindex="-1"><a class="header-anchor" href="#ios"><span>iOS</span></a></h3><p>在iOS系统中是通过给<code>body</code>设置<code>-webkit-text-size-adjust</code>属性来调整的，所以可以通过添加下面的CSS代码来禁用字体缩放功能。</p><div class="language-css line-numbers-mode" data-ext="css" data-title="css"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">text-size-adjust</span><span class="token punctuation">:</span> none <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token property">-webkit-text-size-adjust</span><span class="token punctuation">:</span> none <span class="token important">!important</span><span class="token punctuation">;</span>
  <span class="token property">-moz-text-size-adjust</span><span class="token punctuation">:</span> none <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="android" tabindex="-1"><a class="header-anchor" href="#android"><span>Android</span></a></h3><p>安卓系统中调整字体大小的实现是通过改变浏览器的渲染行为实现的，所以无法通过简单添加一些属性来禁用。经过搜索发现可以重写点击字体调整菜单时触发的事件来禁用缩放行为。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token doc-comment comment">/**
 * Disable the font size scaling function, only for Android.
 * For iOS, just set the css property &#39;text-size-adjust&#39; to &#39;none !important&#39;.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">disableFontSizeScaling</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isAndroidBrowser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> WeixinJSBridge <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> WeixinJSBridge<span class="token punctuation">.</span>invoke <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">handleFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;WeixinJSBridgeReady&#39;</span><span class="token punctuation">,</span> handleFontSize<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">handleFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Set font size as default.</span>
    WeixinJSBridge<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&#39;setFontSizeCallback&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&#39;fontSize&#39;</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">// Override the callback of setting font.</span>
    WeixinJSBridge<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;menu:setfont&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      WeixinJSBridge<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&#39;setFontSizeCallback&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&#39;fontSize&#39;</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Enable the font size scaling function, only for Android.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">enableFontSizeScaling</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isAndroidBrowser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> WeixinJSBridge <span class="token operator">===</span> <span class="token string">&#39;object&#39;</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> WeixinJSBridge<span class="token punctuation">.</span>invoke <span class="token operator">===</span> <span class="token string">&#39;function&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">handleFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;WeixinJSBridgeReady&#39;</span><span class="token punctuation">,</span> handleFontSize<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token function">handleFontSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Resume the callback of setting font.</span>
    WeixinJSBridge<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;menu:setfont&#39;</span><span class="token punctuation">,</span> <span class="token parameter">param</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      WeixinJSBridge<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">&#39;setFontSizeCallback&#39;</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7);function m(h,b){const a=e("ExternalLinkIcon");return p(),i("div",null,[u,s("p",null,[n("在之前的工作中有两个页面需要使用"),s("a",d,[n("html2canvas"),o(a)]),n("直接将页面转换为分享海报，如果不禁用字体缩放功能，那么生成的海报图片会完全乱掉，无法展示活动信息也无法扫描活动二维码。")]),k,c(" more "),v])}const f=t(r,[["render",m],["__file","disable-font-scaling-on-the-h5-page.html.vue"]]),y=JSON.parse('{"path":"/wechat/disable-font-scaling-on-the-h5-page.html","title":"禁用微信浏览器H5页面中的字体缩放功能","lang":"zh-CN","frontmatter":{"title":"禁用微信浏览器H5页面中的字体缩放功能","tag":["微信","H5"],"description":"为了提高页面的可访问性，使用微信内置浏览器打开H5页面时，用户可以通过点击右上角菜单中的调整字体来放大或缩小文字，以达到最佳的阅读效果。这个功能对于许多老人或者视力障碍人士非常有用，但是如果页面没有专门适配不同的字体大小，那么页面布局就会变得非常混乱。 在之前的工作中有两个页面需要使用html2canvas直接将页面转换为分享海报，如果不禁用字体缩放功...","head":[["meta",{"property":"og:url","content":"https://blog.sunrisenew.cn/wechat/disable-font-scaling-on-the-h5-page.html"}],["meta",{"property":"og:site_name","content":"sunrisenew"}],["meta",{"property":"og:title","content":"禁用微信浏览器H5页面中的字体缩放功能"}],["meta",{"property":"og:description","content":"为了提高页面的可访问性，使用微信内置浏览器打开H5页面时，用户可以通过点击右上角菜单中的调整字体来放大或缩小文字，以达到最佳的阅读效果。这个功能对于许多老人或者视力障碍人士非常有用，但是如果页面没有专门适配不同的字体大小，那么页面布局就会变得非常混乱。 在之前的工作中有两个页面需要使用html2canvas直接将页面转换为分享海报，如果不禁用字体缩放功..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-10T06:00:25.000Z"}],["meta",{"property":"article:author","content":"sunrisenew"}],["meta",{"property":"article:tag","content":"微信"}],["meta",{"property":"article:tag","content":"H5"}],["meta",{"property":"article:modified_time","content":"2024-03-10T06:00:25.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"禁用微信浏览器H5页面中的字体缩放功能\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-03-10T06:00:25.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"sunrisenew\\",\\"url\\":\\"https://blog.sunrisenew.cn\\",\\"email\\":\\"sunrisenew@foxmail.com\\"}]}"]]},"headers":[{"level":2,"title":"解决方法","slug":"解决方法","link":"#解决方法","children":[{"level":3,"title":"iOS","slug":"ios","link":"#ios","children":[]},{"level":3,"title":"Android","slug":"android","link":"#android","children":[]}]}],"git":{"createdTime":1710050425000,"updatedTime":1710050425000,"contributors":[{"name":"sunrisenew","email":"sunrisenew@foxmail.com","commits":1}]},"readingTime":{"minutes":1.77,"words":531},"filePathRelative":"wechat/disable-font-scaling-on-the-h5-page.md","localizedDate":"2024年3月10日","excerpt":"<p>为了提高页面的可访问性，使用微信内置浏览器打开H5页面时，用户可以通过点击右上角菜单中的<code>调整字体</code>来放大或缩小文字，以达到最佳的阅读效果。这个功能对于许多老人或者视力障碍人士非常有用，但是如果页面没有专门适配不同的字体大小，那么页面布局就会变得非常混乱。</p>\\n<p>在之前的工作中有两个页面需要使用<a href=\\"https://github.com/niklasvh/html2canvas\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">html2canvas</a>直接将页面转换为分享海报，如果不禁用字体缩放功能，那么生成的海报图片会完全乱掉，无法展示活动信息也无法扫描活动二维码。</p>\\n<p>所以如果这项功能对业务常用人群没有太大的作用或者某些页面强制要求禁止缩放，我们可以禁用这项功能。</p>\\n","autoDesc":true}');export{f as comp,y as data};
